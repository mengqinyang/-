"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,a,i,r,o,c=gap,s=t[e];switch(s&&"object"==typeof s&&"function"==typeof s.toJSON&&(s=s.toJSON(e)),"function"==typeof rep&&(s=rep.call(t,e,s)),typeof s){case"string":return quote(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(s)){for(r=s.length,n=0;n<r;n+=1)o[n]=str(n,s)||"null";return i=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+c+"]":"["+o.join(",")+"]",gap=c,i}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;n<r;n+=1)"string"==typeof rep[n]&&(a=rep[n],i=str(a,s),i&&o.push(quote(a)+(gap?": ":":")+i));else for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(i=str(a,s),i&&o.push(quote(a)+(gap?": ":":")+i));return i=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+c+"}":"{"+o.join(",")+"}",gap=c,i}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var a;if(gap="",indent="","number"==typeof n)for(a=0;a<n;a+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,a,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(a=walk(i,n),void 0!==a?i[n]=a:delete i[n]);return reviver.call(e,t,i)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>0,n=Number(arguments[1])||0;for(n=n<0?Math.ceil(n):Math.floor(n),n<0&&(n+=t);n<t;n++)if(n in this&&this[n]===e)return n;return-1}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.map||(Array.prototype.map=function(e,t){var n,a,i;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),o=r.length>>>0;if("[object Function]"!=Object.prototype.toString.call(e))throw new TypeError(e+" is not a function");for(t&&(n=t),a=new Array(o),i=0;i<o;){var c,s;i in r&&(c=r[i],s=e.call(n,c,i,r),a[i]=s),i++}return a}),Array.prototype.filter||(Array.prototype.filter=function(e,t){"use strict";if(void 0===this||null===this)throw new TypeError;var n=Object(this),a=n.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=[],t=arguments.length>=2?arguments[1]:void 0,r=0;r<a;r++)if(r in n){var o=n[r];e.call(t,o,r,n)&&i.push(o)}return i}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,a;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),r=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),a=0;a<r;){var o;a in i&&(o=i[a],e.call(n,o,a,i)),a++}}),function(e){e||(e=window.console={log:function(e,t,n,a,i){},info:function(e,t,n,a,i){},warn:function(e,t,n,a,i){},error:function(e,t,n,a,i){}}),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){return t.apply(e,Array.prototype.concat.apply(n,arguments))}}),"object"==typeof e.log&&(e.log=Function.prototype.call.bind(e.log,e),e.info=Function.prototype.call.bind(e.info,e),e.warn=Function.prototype.call.bind(e.warn,e),e.error=Function.prototype.call.bind(e.error,e)),"groupCollapsed"in e||(e.groupCollapsed=function(t){e.info("\n------------\n"+t+"\n------------")}),"group"in e||(e.group=function(t){e.info("\n------------\n"+t+"\n------------")}),"groupEnd"in e||(e.groupEnd=function(){}),"time"in e||function(){var t={};e.time=function(e){t[e]=(new Date).getTime()},e.timeEnd=function(n){var a=(new Date).getTime(),i=n in t?a-t[n]:0;e.info(n+": "+i+"ms")}}()}(window.console),$(function(){function Renderer(){}var $=jQuery,win=window,doc=document,VIP;VIP=win.VIP=win.VIP||{},win.mstHost=window.intfHost||"//mst.vip.com",win.mstStaticHost=window.mstStaticHost||"//mst.vipstatic.com";var container=$("#specialContent");VIP.tempData={productList:[],brandList:[]},$.extend(Renderer.prototype,{isInited:!1,nextReloadTime:0,pluginHeight:0,pluginIndex:0,pluginList:[],threshold:1e3,userScroll:!1,preloadHeight:1.5*document.documentElement.clientHeight,init:function(e){var t=this;this.config=e.config,this.container=container,this.addMarsRoot(),this.render(),this.bind(),setTimeout(function(){t.preload()},100)},initReload:function(){var e,t=new Date,n=new Date,a=new Date,i=+new Date,r=Math.round(3e5*Math.random());t.setMinutes(0),t.setHours(10),t=+t,n.setMinutes(0),n.setHours(20),n=+n,a.setMinutes(0),a.setHours(10),a=+a+864e5,e=i<t?t+r:i>n?a+r:n+r;setInterval(function(){var t=+new Date;t>e&&location.reload()},1e3)},render:function(){var e=this,t=this.config.module_type_id?[this.config]:this.config.data.moduleList,n=["custom_pc"];e.appendCss();for(var a=t.length-1;a>=0&&!e.checkLastModule(t[a]);a--);$.each(t,function(a,i){var r,o,c=n.indexOf(i.module_type_id)==-1,s="share"==i.module_type_id?"1":i.extend&&i.extend.grade||"3",d=i.extend;d?d.page:{};r=i.extend?i.extend.layout||{}:{},o=parseInt(r.height||0)||0;var u=$("<div>").addClass("plugin").attr("mars_container_slice","");i.model&&i.model.anchor&&u.attr("id",i.model.anchor),e.pluginList.push(u.attr("data-index",a)),o=e.setComponentDefaultHeight(i,o),c&&o&&u.height(o),u.appendTo(e.container),e.pluginHeight<=e.preloadHeight&&(c&&(e.pluginHeight+=o),e.pluginIndex++,e.createModule(i,a),e.clearDomHeight(u)),"1"==s&&(e.createModule(i,a),e.clearDomHeight(u)),a==t.length-1&&e.handleLast(!0)})},setComponentDefaultHeight:function(e,t){var n="1"===VIP.getConfigValueByKey("extend","switch","is_set_component_default_height"),a=["brand_pc","product_pc"];if(n&&a.indexOf(e.module_type_id)>-1){var i=$.extend({page:{amount:0,limit:30}},e.extend),r=i.page,o=VIP.getConfigValueByKey("data","style_extend"),c=o?o[e.style_id]:{column_per_line:0,column_per_height:0},s=c.column_per_line,d=c.column_per_height,u=r.amount>r.limit?r.limit:r.amount,l=document.documentElement.clientHeight+10;t=u&&s&&d?u/s*d:l}return t},handleLast:function(e){var t='<div id="J_notify_tips" class="notify-tips"></div>';$("body").append(t),$("img.mst-lazy").lazyload({threshold:500,effect:"fadeIn",load:function(){this.removeAttribute("height")}}),this.checkExtraAnchor(),VIP.Communication.dispatch("component-event-broadcast-done")},checkLastModule:function(e){return!("brand"!=e.module_type_id&&"product"!=e.module_type_id&&"haitao"!=e.module_type_id&&"beauty"!=e.module_type_id&&"collect"!=e.module_type_id&&"channel"!=e.module_type_id||!e.extend||"true"!=e.extend.page.isPaging)&&(e.isLast=!0,!0)},createModule:function(e,t){if(!e.isLoaded){var n=this,a=this.pluginList[t],i='<div class="u-loading u-more-btn J_pager_more"></div>',r=""==e.template&&e.style_id?window.config.data.htmlList[e.style_id]:e.template;""==e.js&&e.style_id?window.config.data.jsList[e.style_id]:e.js;e.isLoaded=!0,a.attr("data-loaded","true").append(r),e.isLast&&a.append(i);var o=n.isSyncComponent(e.module_type_id);o?n.requestData(a,e,t):n.evalJs(a,e,t)}},evalJs:function($dom,config,index){var that=this,js=!config.js&&config.style_id?window.config.data.jsList[config.style_id]:config.js;try{eval("(function(){return function(dom, config, index){"+js+"}})()").call($dom,$dom,config,index)}catch(e){console.log(e.message)}setTimeout(function(){that.initMars($dom,config,index)},1e3)},getCssString:function(e){return"<style>"+e+"</style>"},addMarsRoot:function(){window.config&&window.config.data.id&&$("head").append('<meta name="mars_root" content="'+window.config.data.id+'" />'),window.MarConfig=$.extend(window.MarConfig,{pageType:"mst"})},checkExtraAnchor:function(){var e=!!VIP.getQueryString("extra_anchor")&&VIP.getQueryString("extra_anchor"),t=$("[data-anchor-name="+e+"]");e&&t.length&&setTimeout(function(){$("html, body").animate({scrollTop:t.offset().top},200)},100)},appendCss:function(){var e=this,t=e.config.data&&e.config.data.cssList?e.config.data.cssList:[],n="";t&&($.each(t,function(e,t){n+=t}),e.container.append(e.getCssString(n)))},initMars:function(e,t,n){var a=window.config;a&&(VIP.Mars.set(e,n),++n,e.on("click","[mst-mars]",{},function(a){var i=$(this),r=$(a.target),o=e.find("[mst-mars]"),c="undefined"==typeof i.attr("mst-mars")?r.parents("[mst-mars]:eq(0)"):i,s=+o.index(c)+1,d=+n+"_"+s,u=VIP.Mars.get(c.attr("mst-mars"),d),l={module:n+"",seq:s+""},p="mst_"+t.module_type_id+"_click";u=$.extend(u,l),console.log(JSON.stringify(u)),Mar.Seed.request(r[0].tagName.toLowerCase(),"click",p,JSON.stringify(u))}))},clearDomHeight:function(e,t){var t=t||1e3;setTimeout(function(){e.css({height:"auto"}).addClass("plugin-loaded")},t)},bind:function(){var e=this;$(win).bind("touchstart touchmove scroll",function(t){e.preload()})},preload:function(){var e=this,t=doc.body.scrollTop||doc.documentElement.scrollTop;e.userScroll=!0,e.container.find(".plugin").each(function(n,a){if(!this.getAttribute("data-loaded")){var i=$(this),r=i.attr("data-index"),o=Math.floor(i.offset().top);t+2*document.documentElement.clientHeight>=o&&o>t-i.height()&&(e.createModule(window.config.data.moduleList[r],r),e.clearDomHeight(e.pluginList[r]))}})},requestData:function(e,t,n,a){var i=this,r=t.model||{},o=($.extend({page:{is_personality:!0,limit:30}},t.extend),t.extend.page);switch(t.module_type_id){case"purchase_pc":var c={plugin_id:t.id,floor:t.floor,client:VIP.defaultParam.client,warehouse:VIP.defaultParam.warehouse};VIP["interface"].getPurchaseData(c).done(function(a){t.data=a.data,i.handleAfterAcceptData(e,t,n)}).fail(function(e){console.log("楼层"+n+"品购数据加载失败,楼层渲染没有渲染！")});break;case"brand_pc":var c={floor:t.floor,is_personality:o.is_personality||!0,plugin_id:t.id,offset:0,limit:o.limit||30},s=parseInt(r.total);VIP["interface"].getBrandData(c).done(function(a){t.data=a.data,t.extend&&$.extend(!0,t.extend.page,a.page,{offset:a.page.limit,total:s||a.page.amount}),i.handleAfterAcceptData(e,t,n)}).fail(function(e){console.log("楼层"+n+"档期数据加载失败,楼层渲染没有渲染！")});break;case"product_pc":var c={floor:t.floor,is_personality:o.is_personality||!0,is_sinking:o.is_sinking||!0,plugin_id:t.id,is_pre_pay:r.is_pre_pay||"0",offset:0,limit:o.limit||30},s=parseInt(r.total);VIP["interface"].getProductData(c).done(function(a){t.data=a.data,t.extend&&$.extend(!0,t.extend.page,a.page,{offset:a.page.limit,total:s||a.page.amount}),i.handleAfterAcceptData(e,t,n)}).fail(function(e){console.log("楼层"+n+"商品数据加载失败,楼层渲染没有渲染！")});break;case"category_pc":var c={page_id:t.page_data.page_id,plugin_id:t.id,client:"vipcms",warehouse:VIP.defaultParam.warehouse||"VIP_NH",from:window.location.href.indexOf("mst-admin")>-1?0:1,mars_cid:VIP.defaultParam.mars_cid||""};t.need_asynchronous&&1===+t.need_asynchronous&&t.model.is_personality&&"true"==t.model.is_personality?VIP["interface"].getCategory(c).done(function(a){t.data=a.data,i.handleAfterAcceptData(e,t,n)}).fail(function(e){console.log("楼层"+n+"品类数据加载失败,楼层渲染没有渲染！")}):i.handleAfterAcceptData(e,t,n);break;default:i.handleAfterAcceptData(e,t,n)}},handleAfterAcceptData:function(e,t,n){this.evalJs(e,t,n),this.afterEvalJs(e,t,n)},afterEvalJs:function(e,t,n){},isSyncComponent:function(e){var t=VIP.getConfigValueByKey("extend","switch","homepage_async_plugins")||"",n=!1;return t.indexOf(e)>-1&&(n=!0),n}}),VIP.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null},VIP.loadScript=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.onload=function(){t()},n.src=e,document.body.appendChild(n)},VIP.cookie=function(e,t,n){if("undefined"==typeof t){var a=null;if(document.cookie&&""!=document.cookie)for(var i=document.cookie.split(";"),r=0;r<i.length;r++){var o=jQuery.trim(i[r]);if(o.substring(0,e.length+1)==e+"="){a=decodeURIComponent(o.substring(e.length+1));break}}return a}n=n||{},null===t&&(t="",n.expires=-1);var c="";if(n.expires&&("number"==typeof n.expires||n.expires.toUTCString)){var s;"number"==typeof n.expires?(s=new Date,s.setTime(s.getTime()+24*n.expires*60*60*1e3)):s=n.expires,c="; expires="+s.toUTCString()}var d=n.path?"; path="+n.path:"",u=n.domain?"; domain="+n.domain:"",l=n.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),c,d,u,l].join("")},VIP.countdown=function(e){var t=new Date(e).getTime()-(new Date).getTime(),n={time:t,day:"00",hour:"00",min:"00",sec:"00"},a="";return t>0&&(a="0"+parseInt(t/1e3%60),n.sec=a.substr(a.length-2),a="0"+parseInt(t/1e3/60%60),n.min=a.substr(a.length-2),a="0"+parseInt(t/1e3/60/60%60),n.hour=a.substr(a.length-2),a="0"+parseInt(t/1e3/60/60/24%60),n.day=a.substr(a.length-2)),n},VIP.link=function(){function e(e,t){t&&"blank"!=t?location.href=e:window.open(e)}var t={};return t.BRAND="//list.vip.com/{brand}.html",t.PRODUCT="//www.vip.com/detail-{brand}-{product}.html",t.SPECIAL="//act.vip.com/{sid}.html",t.go=function(n,a,i){var r,o="all",c=a;switch(a&&"object"==typeof a&&(o=defaultParam.warehouse||"nh",c=a[o]),n){case"special":location.href=t.SPECIAL.replace(/{sid}/g,c);break;case"brand":r=t.BRAND.replace(/{brand}/g,c),e(r,i);break;case"product":var s=c.match(/(\d*)-(\d*)/)[1],d=c.match(/(\d*)-(\d*)/)[2];r=t.PRODUCT.replace(/{brand}/g,s).replace(/{product}/g,d),e(r,i);break;case"url":e(a,i);break;case"index":r="//www.vip.com",location.href=r}},t}(),VIP.stringToDate=function(e){if("undefined"==typeof e)return new Date;if("date"==typeof e)return e;var t=Date.parse(e),n=new Date(t);if(isNaN(n)){e=e.replace(/:/g,"-"),e=e.replace(" ","-"),e=e.replace(".","-");var a=e.split("-");switch(a.length){case 7:n=new Date(a[0],(--a[1]),a[2],a[3],a[4],a[5],a[6]);break;case 6:n=new Date(a[0],(--a[1]),a[2],a[3],a[4],a[5]);break;default:n=new Date(a[0],(--a[1]),a[2])}}return n},VIP.Communication=function(){var e=$(document),t=[];return{dispatch:function(t){e.trigger(t,arguments)},listen:function(n,a){e.on(n,a),t.indexOf(n)===-1&&"component-event-broadcast"!=n&&t.push(n)},getEventList:function(){return t}}}(),VIP.getIdByUrl=function(e,t,n){if(!e||""==e)return 0;var a,i=/(.*\/){0,}([^.]+).*/gi,r=0;return e.indexOf("msp.appvipshop.com")>-1?e.indexOf("/cmstopic/")>-1?r=e.replace(i,"$2"):e.indexOf("/vis/")>-1?(a=/\/pages\/(\d+)\//,r=e.match(a)[1]):e.indexOf("wapid=mzt")>-1&&(r=VIP.getQueryStringByUrl(e,"wapid")):e.indexOf("mst.vip.com")>-1?r=VIP.getQueryStringByUrl(e,"wapid"):e.indexOf("ma.vip.com")>-1?r=VIP.getQueryStringByUrl(e,"wapid"):e.indexOf("viva.vip.com")>-1?r=VIP.getQueryStringByUrl(e,"wapid"):e.indexOf("mzt.vip.com")>-1&&(r=VIP.getQueryStringByUrl(e,"wapid")),r=""==r?0:r},VIP.getConfigValueByKey=function(){if(!window.config)return"";var e=window.config;return $.each(arguments,function(t,n){e=e[n]?e[n]:""}),e},VIP.getQueryStringByUrl=function(e,t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),a=e.split("?")[1];if(a){var i=e.split("?")[1].match(n);if(null!=i)return unescape(i[2])}return""},VIP.initDefaulParam=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,a=e.getDate(),i=t+""+n+a,r=Math.ceil((new Date).getTime()/1e3/300),r=i+""+r,o=this.getQueryString("client"),c=this.getQueryString("warehouse")||VIP.getConfigValueByKey("data","page_data","warehouse")||"VIP_NH",s=3,d=VIP.cookie("vip_city_code"),u=VIP.cookie("mars_cid"),l=this.getQueryString("is_preload"),p=this.getQueryString("newcustomer"),f=this.getQueryString("wap_consumer"),g=(this.getQueryString("m"),location.href.replace(/&/g,"%@^_")),m=(this.getQueryString("user_id"),this.getQueryString("extra_tag")),h=this.getQueryString("wapid")||"mst_"+VIP.getConfigValueByKey("data","id"),_=VIP.getConfigValueByKey("data","id"),y=VIP.getConfigValueByKey("data","build_id"),v=VIP.getQueryString("group_id")||VIP.getQueryString("extra_source_id")||VIP.getQueryString("extra_banner")||0,w=VIP.getConfigValueByKey("data","page_data","page_show_type"),P="2"===VIP.getConfigValueByKey("extend","user_type","user_consumer")?1:0,x="frontend"===w?1:0;if(!x){var I={VIP_NH:{area_id:"104104",name:"广东"},VIP_BJ:{area_id:"101101",name:"北京"},VIP_SH:{area_id:"103101",name:"上海"},VIP_CD:{area_id:"105101",name:"四川"},VIP_HZ:{area_id:"104102",name:"湖北"}};d=I[c].area_id}d=d?d:0,this.defaultParam={verstr:r,client:o,warehouse:c,area_id:d,mars_cid:u,is_preload:l,newcustomer:p,wap_consumer:f,item_id:s,referer_currurl:g,mst_mars:m,wap_id:h,page_id:_,special_id:y,page_show_type:w,extra_banner:v,protocol_version:VIP.getQueryString("protocol_version"),log:[],is_old_consumer:P}},VIP.initDefaulParam(),VIP.Mars={get:function(e,t){var e=e.split("|"),n=this.getTag(e,t),a=VIP.getQueryString("extra_tag")?VIP.getQueryString("extra_tag")+",":"",i=a+n,r={page:encodeURIComponent(document.title),wap_id:VIP.defaultParam.wap_id,special_id:VIP.defaultParam.special_id,banner_id:VIP.defaultParam.extra_banner,tag:i},o=t?t.split("_"):[];if(0==e.length)return r;switch(e[0]){case"brand":r.target_type=e[0],r.target_id=e[1],r.brand_id=e[1],r.brand_rank=t,r.brandtyp="0";break;case"product":r.target_type=e[0],r.target_id=e[2],r.brand_id=e[1],r.goods_id=e[2],r.brand_rank=t,r.brandtyp="1";break;case"url":e[0]&&(r.target_type=e[0]),e[1]&&(r.target_id=VIP.getIdByUrl(e[1]));break;default:e[0]&&(r.target_type=e[0]),e[1]&&(r.target_id=e[1]),o[0]&&(r.module=o[0]),o[1]&&(r.seq=o[1])}return r},set:function(e,t){var n=this,a=e;if(a){++t;var i=VIP.tempData.brandList[t]=[],r=VIP.tempData.productList[t]=[];a.find("[mst-mars]").each(function(e,a){var o=$(this),c=o.attr("mst-mars")&&o.attr("mst-mars").split("|"),s=t+"_"+(e+1),d=c[0],u=n.getTag(c,s)||"";switch(d){case"brand":c[1]&&i.indexOf(c[1])===-1&&(i.push(c[1]),o.attr("mars_exposure_sead","special_slide_expose").attr("mars_exposure_module","pc|brands|"+c[1]+"|0|"+s+"|0"));break;case"product":c[1]&&c[2]&&r.indexOf(c[2])===-1&&(r.push(c[2]),o.attr("mars_exposure_sead","special_slide_expose").attr("mars_exposure_module","pc|products|"+c[1]+"|0|"+s+"|1|"+c[2]))}o.attr("mst-rank",s),o.attr("mst-tag",u)})}},send:function(e,t,n){var a=VIP.Mars.get(t,n);Mar.Seed.request("mst","click",e,JSON.stringify(a))},getTag:function(e,t){var n=e[0],a=VIP.defaultParam.special_id||0,i=VIP.defaultParam.extra_banner||0,r="",o=(new Date).getTime(),c=i+"_"+a+"_"+t+"_"+o;switch(n){case"brand":r=e[1];break;case"product":r=e[2];break;case"url":r=VIP.getIdByUrl(e[1]);break;case"vis":r=VIP.getIdByUrl(e[1]);break;default:r=e[1]?e[1]:0}return r=c+"_"+r}},VIP.isInSale=function(e){var t=(new Date).getTime(),e=new Date(e).getTime();return!(t<e)},VIP["interface"]={getPmsRe:function(e){return e&&e.length>0?$.ajax({url:"//pmsgw.vip.com/1.0.2/jsonActiveTipsIndex",dataType:"jsonp",data:e}):void console.log("PmsRe接口参数不正确！")},getProductCoupon:function(e){return e&&e.length>0?$.ajax({url:"//act.vip.com/act/index_ajax.php?service=NewCoupon.getAllBatch",dataType:"jsonp",data:e}):void console.log("商品红包接口参数不正确！")},getBrandCoupon:function(e){return e&&e.length>0?$.ajax({url:"//act.vip.com/act/index_ajax.php?service=NewCoupon.bind",dataType:"jsonp",data:e}):void console.log("档期红包接口参数不正确！")},getProductFavorite:function(e){return e&&e.length>0?$.ajax({url:"//myi.vip.com/fav_sku",dataType:"jsonp",data:e}):void console.log("商品收藏接口参数不正确！")},getProductStock:function(e,t){var n="1"===VIP.getSwitch("is_use_stock_apis");return n?VIP["interface"].checkStockByStockApi(data,t):e&&e.length>0?$.ajax({url:"//mst.vip.com/Stock/checkStock",dataType:"jsonp",data:{product_id:e.join(","),is_mobile:0}}):void console.log("档期红包接口参数不正确！")},checkStockByStockApi:function(e,t){function n(e){var t=e.split(",");return VIP["interface"].sliceArr(t,c)}function a(e){if(200===e.code){var t=(e.data,{});e.code=1,e.result=!0,e.data&&e.data.length&&$.each(e.data,function(e,n){t[n.id]=n}),e.data=t,delete e.info}return e}function i(t){return $.each(t,function(t,n){$.extend(e,{mids:n.join(","),area_id:o.area_id,mars_cid:o.mars_cid,realSale:!1,stockType:0,is_mobile:0,is_old:o.is_old_consumer?1:0,fields:"min,max,stock,type"}),delete e.product_id;var a=new $.Deferred;$.ajax({url:r,data:e,dataType:"jsonp"}).then(function(e){a.resolve(e)},function(e){a.resolve(e)}),s.push(a.promise())}),s}var r="//stock.vip.com/merchandise/",o=VIP.defaultParam,c=50,s=[],d=n(e.product_id);return $.when.apply(null,i(d)).then(function(){var e=new $.Deferred,n=!1,i={code:200,data:[]};return $.each(arguments,function(e,t){t&&200==t.code&&t.data&&(n=!0,i.data=i.data.concat(t.data))}),n?(i=a(i),t?t(i):i.result?$.each(i.data,function(e,t){t&&$("[data-soldout-productid="+t+"]").show()}):console.log("商品库存接口返回错误！"),e.resolve(i),e.promise()):void console.log("商品库存接口返回错误！")},function(e){console.log("商品库存接口返回错误！")})},getBrandFavorite:function(e){return e&&e.length>0?$.ajax({url:"//fav.vip.com/api/stats/brand/sn/count",dataType:"jsonp",data:e}):void console.log("档期收藏接口参数不正确！")},getBrandData:function(e){var e=$.extend({page_id:VIP.defaultParam.page_id,floor:"1f",mars_cid:VIP.defaultParam.mars_cid,is_personality:!0,plugin_id:"",offset:0,limit:30,client:"vipcms"},e,{time:VIP.defaultParam.time,is_front:VIP.defaultParam.is_front});return $.ajax({url:window.mstHost+"/Special/getBrandData",dataType:"jsonp",data:e}).fail(function(e){console.log("获取档期数据失败")})},getProductData:function(e){var e=$.extend({page_id:VIP.defaultParam.page_id,floor:"1f",mars_cid:VIP.defaultParam.mars_cid,is_personality:!0,is_sinking:!0,plugin_id:"",offset:0,limit:30,client:"vipcms"},e,{time:VIP.defaultParam.time,is_front:VIP.defaultParam.is_front});return $.ajax({url:window.mstHost+"/Special/getProductData",dataType:"jsonp",data:e}).fail(function(e){console.log("获取档期数据失败")})},getPurchaseData:function(e){var e=$.extend({page_id:VIP.defaultParam.page_id,plugin_id:""},e,{time:VIP.defaultParam.time,is_front:VIP.defaultParam.is_front});return $.ajax({url:window.mstHost+"/Special/getPurchases",dataType:"jsonp",data:e}).fail(function(e){console.log("获取品购数据失败")})},getCategory:function(e){return e.page_id&&e.plugin_id&&e.warehouse?$.ajax({url:window.mstHost+"/Special/getCategoryByAsynchronous",dataType:"jsonp",data:e}).fail(function(e){console.log("获取品类数据失败")}):void console.log("getCategory接口参数不正确！")},sliceArr:function(e,t){var n=[];t=t||1;for(var a=0;a<Math.ceil(e.length/t);a++){var i=a*t,r=i+t;n.push(e.slice(i,r))}return n}},VIP.imgSrcHandler=function(e){return e=e.replace(/http(s?):/,"")},VIP.init=function(){$.ajaxSetup({beforeSend:function(e,t){}})}(),win.renderer=new Renderer,win.config&&win.renderer.init({config:win.config})});